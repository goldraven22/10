<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TEN Trucking Network</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ipfs-http-client/dist/index.min.js"></script>
</head>
<body>

<h1>TEN Trucking Network â€” Join & Monetize Your Profile</h1>

<form id="driverForm">
  <h2>Driver Profile</h2>
  
  <label>Name:</label>
  <input type="text" id="name" required>
  
  <label>Email:</label>
  <input type="email" id="email" required>
  
  <label>Phone:</label>
  <input type="tel" id="phone" required>
  
  <label>CDL Class:</label>
  <select id="cdlClass" required>
    <option value="A">A</option>
    <option value="B">B</option>
    <option value="C">C</option>
  </select>

  <label>Endorsements:</label>
  <input type="checkbox" id="hazmat">HazMat
  <input type="checkbox" id="tanker">Tanker
  <input type="checkbox" id="doubles">Doubles/Triples
  <input type="checkbox" id="passenger">Passenger
  <input type="checkbox" id="twic">TWIC

  <label>Driver Type:</label>
  <select id="driverType" required>
    <option value="Company">Company Driver</option>
    <option value="Owner-Operator">Owner-Operator</option>
    <option value="Fleet">Fleet Owner</option>
  </select>

  <label>Fleet Size:</label>
  <input type="number" id="fleetSize" min="0" value="0">

  <label>Years Driving:</label>
  <input type="number" id="experience" min="0" value="0">

  <label>Equipment Type:</label>
  <select id="equipment">
    <option value="Dry Van">Dry Van</option>
    <option value="Reefer">Reefer</option>
    <option value="Flatbed">Flatbed</option>
    <option value="Step Deck">Step Deck</option>
    <option value="Hotshot">Hotshot</option>
    <option value="Box Truck">Box Truck</option>
  </select>

  <label>ELD System:</label>
  <input type="text" id="eldSystem">

  <label>Route Preference:</label>
  <select id="route">
    <option value="Local">Local</option>
    <option value="Regional">Regional</option>
    <option value="OTR">OTR</option>
  </select>

  <label>Home City/State:</label>
  <input type="text" id="homeLocation">

  <label>Pay Structure:</label>
  <select id="payStructure">
    <option value="CPM">CPM</option>
    <option value="Percentage">Percentage</option>
    <option value="Day Rate">Day Rate</option>
    <option value="Owner-Op Rate">Owner-Op Rate</option>
  </select>

  <label>Insurance Provider (optional):</label>
  <input type="text" id="insurance">

  <label>Load Preferences:</label>
  <input type="checkbox" id="teamDriving">Team Driving
  <input type="checkbox" id="hazmatLoad">HazMat loads
  <input type="checkbox" id="portLoads">Port Loads
  <input type="checkbox" id="oversize">Oversize

  <label>Consent to Store & License Data:</label>
  <input type="checkbox" id="consent" required> I consent

  <button type="submit">Join Network</button>
</form>

<div id="confirmation"></div>

<script>
const form = document.getElementById('driverForm');
const confirmation = document.getElementById('confirmation');

// Initialize IPFS
const ipfs = window.IpfsHttpClient.create({url: 'https://ipfs.infura.io:5001/api/v0'});

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  
  if(!document.getElementById('consent').checked){
    alert('Consent required.');
    return;
  }

  // Collect form data
  const data = {
    name: document.getElementById('name').value,
    email: document.getElementById('email').value,
    phone: document.getElementById('phone').value,
    cdlClass: document.getElementById('cdlClass').value,
    endorsements: {
      hazmat: document.getElementById('hazmat').checked,
      tanker: document.getElementById('tanker').checked,
      doubles: document.getElementById('doubles').checked,
      passenger: document.getElementById('passenger').checked,
      twic: document.getElementById('twic').checked
    },
    driverType: document.getElementById('driverType').value,
    fleetSize: document.getElementById('fleetSize').value,
    experience: document.getElementById('experience').value,
    equipment: document.getElementById('equipment').value,
    eldSystem: document.getElementById('eldSystem').value,
    route: document.getElementById('route').value,
    homeLocation: document.getElementById('homeLocation').value,
    payStructure: document.getElementById('payStructure').value,
    insurance: document.getElementById('insurance').value,
    loadPreferences: {
      teamDriving: document.getElementById('teamDriving').checked,
      hazmatLoad: document.getElementById('hazmatLoad').checked,
      portLoads: document.getElementById('portLoads').checked,
      oversize: document.getElementById('oversize').checked
    },
    timestamp: new Date().toISOString()
  };

  // Encrypt sensitive info
  const secretKey = 'YOUR_SECRET_KEY'; // keep offline
  const encrypted = CryptoJS.AES.encrypt(JSON.stringify(data), secretKey).toString();

  try {
    // Upload encrypted data to IPFS
    const result = await ipfs.add(encrypted);
    console.log('IPFS CID:', result.path);

    // Here you can call a smart contract function to store metadata + CID
    // e.g., driverMetadata = {cdlClass, endorsements, route, cid: result.path}

    confirmation.innerHTML = `Profile submitted! IPFS CID: ${result.path}`;
  } catch(err){
    console.error(err);
    confirmation.innerHTML = 'Error submitting profile.';
  }
});
</script>

</body>
</html>